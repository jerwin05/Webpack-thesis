(()=>{const e=document.getElementById("newCases"),t=document.getElementById("activeCases"),n=document.getElementById("newCasesTitle"),o=document.getElementById("activeCasesTitle"),a=document.getElementById("suspected"),d=document.getElementById("probable"),s=document.getElementById("cofirmedCases"),i=document.getElementById("testedNegative"),l=document.getElementById("recovered"),c=document.getElementById("death"),m=document.getElementById("covidUpdateDate"),r=document.getElementById("editNewCases"),p=document.getElementById("editSuspected"),h=document.getElementById("editProbable"),u=document.getElementById("editConfirmedCases"),y=document.getElementById("editTestedNegative"),E=document.getElementById("editRecovered"),C=document.getElementById("editDeath"),g=document.getElementById("editDate"),v=document.getElementById("notes"),b=document.getElementById("covidPatientList"),w=document.getElementById("editCovidUpdateForm"),f=document.getElementById("editCovidUpdateFormErrorMessage"),x=document.getElementById("covidPatientListForm"),B=document.getElementById("addPatientFormContainer"),I=document.getElementById("addPatientForm"),k=document.getElementById("addPatientButton"),N=document.getElementById("addPatientCancelButton"),L=document.getElementById("addPatientFormErrorMessage"),T=(document.getElementById("editPatientButton"),document.getElementById("history")),D=document.getElementById("loadingElement"),_=document.getElementById("announcementLoadingElement"),A=document.getElementById("main"),S=(document.getElementById("block23Container"),document.querySelector("body")),$=document.getElementById("overlay"),P=document.getElementById("successMessage"),j=document.getElementById("errorMessage"),U=document.getElementById("profile"),F=document.getElementById("announcementSection"),O=document.getElementById("announcementForm"),M=document.getElementById("deleteAccount"),J=document.getElementById("overlayNoButton"),H=document.getElementById("overlayYesButton"),q=document.getElementById("logout"),Y="127.0.0.1"===window.location.hostname||"localhost"===window.location.hostname?"http://localhost:3000/index.html":"https://teresa-covid-tracker-test.herokuapp.com/index.html",R="127.0.0.1"===window.location.hostname||"localhost"===window.location.hostname?"http://localhost:3000/authenticate-user":"https://teresa-covid-tracker-test.herokuapp.com/authenticate-user",z="127.0.0.1"===window.location.hostname||"localhost"===window.location.hostname?"http://localhost:3000/admin/profile":"https://teresa-covid-tracker-test.herokuapp.com/admin/profile",G="127.0.0.1"===window.location.hostname||"localhost"===window.location.hostname?"http://localhost:3000/announcement":"https://teresa-covid-tracker-test.herokuapp.com/announcement",K="127.0.0.1"===window.location.hostname||"localhost"===window.location.hostname?"http://localhost:3000/admin/announcement":"https://teresa-covid-tracker-test.herokuapp.com/admin/announcement",Q="127.0.0.1"===window.location.hostname||"localhost"===window.location.hostname?"http://localhost:3000/covid-update":"https://teresa-covid-tracker-test.herokuapp.com/covid-update",V="127.0.0.1"===window.location.hostname||"localhost"===window.location.hostname?"http://localhost:3000/admin/covid-update/active-cases":"https://teresa-covid-tracker-test.herokuapp.com/admin/covid-update/active-cases",W="127.0.0.1"===window.location.hostname||"localhost"===window.location.hostname?"http://localhost:3000/admin/covid-update":"https://teresa-covid-tracker-test.herokuapp.com/admin/covid-update",X="127.0.0.1"===window.location.hostname||"localhost"===window.location.hostname?"http://localhost:3000/patient-list":"https://teresa-covid-tracker-test.herokuapp.com/patient-list",Z="127.0.0.1"===window.location.hostname||"localhost"===window.location.hostname?"http://localhost:3000/admin/patient-list":"https://teresa-covid-tracker-test.herokuapp.com/admin/patient-list",ee="127.0.0.1"===window.location.hostname||"localhost"===window.location.hostname?"http://localhost:3000/patient-list-history":"https://teresa-covid-tracker-test.herokuapp.com/patient-list-history",te="127.0.0.1"===window.location.hostname||"localhost"===window.location.hostname?"http://localhost:3000/admin/patient-list-history":"https://teresa-covid-tracker-test.herokuapp.com/admin/patient-list-history";fetch(R,{}).then((e=>{e.text().then((e=>{"true"!==e&&window.location.replace(Y)}))}));const ne=e=>{D.style.display="",e.innerHTML=""},oe=()=>{fetch(Q).then((b=>{A.style.display="flex",D.style.display="none",b.json().then((b=>{const w=document.createElement("pre"),f=b[0].active_cases,x=b[0].new_cases,B=b[0].suspected,I=b[0].probable,k=b[0].confirmed_cases,N=b[0].tested_negative,L=b[0].recovered,T=b[0].death,D=b[0].date_updated;if(t.textContent=f,e.textContent=x,a.textContent=B,d.textContent=I,s.textContent=k,i.textContent=N,l.textContent=L,c.textContent=T,r.value=x,p.value=B,h.value=I,u.value=k,y.value=N,E.value=L,C.value=T,g.value=D,b[0].new_cases>1?n.textContent="New Cases":n.textContent="New Case",b[0].active_cases>1?o.textContent="Active Cases":o.textContent="Active Case",m.textContent=`${D}`,!b[0].notes||/\s+$/.test(b[0].notes)){const e=document.createElement("p");e.textContent="No notes",v.innerHTML="",v.appendChild(e)}else w.textContent=b[0].notes,v.innerHTML="",v.appendChild(w)}))}))},ae=()=>{fetch(V,{method:"PUT"}).then((e=>{e.text().then((e=>{o.textContent=e>1?"Active Cases":"Active Case",t.textContent=e}))}))},de=()=>{fetch(X).then((e=>{D.style.display="none",e.json().then((e=>{if(e.message){const e=document.createElement("p");e.textContent="No patient",e.className="nopatient",b.appendChild(e)}else e.reverse(),e.forEach((e=>{const t=document.createElement("div"),n=document.createElement("div"),o=document.createElement("div"),a=document.createElement("p"),d=document.createElement("p"),s=document.createElement("p"),i=document.createElement("p"),l=document.createElement("input"),c=document.createElement("button"),m=document.createElement("div"),r=document.createElement("div"),p=document.createElement("p"),h=document.createElement("button"),u=document.createElement("button");a.textContent=e.patient_no,d.textContent=e.age,s.textContent=e.gender.toLowerCase(),i.textContent=e.barangay.toLowerCase(),l.value=e.status.toLowerCase(),l.className="status",l.setAttribute("name",`status${e.id}`),c.textContent="Delete",c.className=" profile--button patient--deletebutton",c.setAttribute("type","button"),t.className="covidpatientlist--table-grid patientDiv",n.className="covidpatientlist--table-grid covidpatientlist--table-templatecolumns",o.className="covidpatientlist--patientdetails covidpatientlist--table-grid",m.className="overlay",r.className="popUp--container",p.textContent="Are you sure you want to delete this patient?",p.setAttribute("class","message"),h.setAttribute("class",`yes deletePatient${e.id}`),u.setAttribute("class","no"),h.setAttribute("type","button"),u.setAttribute("type","button"),h.textContent="Yes",u.textContent="No";const y={id:e.id};c.addEventListener("click",(()=>{m.style.display="flex"})),u.addEventListener("click",(()=>{m.style.display="none"})),h.addEventListener("click",(e=>{e.preventDefault(),ne(b),m.style.display="none",fetch(Z,{method:"DELETE",body:JSON.stringify(y),headers:{"content-type":"application/json"}}).then((e=>{e.text().then((e=>{"recovered"===e?(T.innerHTML="",de(),ae(),se()):(de(),ae())}))}))})),r.appendChild(p),r.appendChild(h),r.appendChild(u),m.appendChild(r),S.appendChild(m),o.appendChild(d),o.appendChild(s),n.appendChild(a),n.appendChild(o),t.appendChild(n),t.appendChild(i),t.appendChild(l),t.appendChild(c),b.appendChild(t)}))}))}))},se=()=>{fetch(ee).then((e=>{D.style.display="none",e.json().then((e=>{if(e.message){const e=document.createElement("p");e.textContent="No history",T.appendChild(e)}else for(var t=0,n=e.history_count;t<n;t++){const n=document.createElement("div"),d=document.createElement("div"),s=document.createElement("span"),i=document.createElement("button"),l=document.createElement("div"),c=document.createElement("div"),m=document.createElement("p"),r=document.createElement("button"),p=document.createElement("button");s.textContent=e[`history${t+1}`].date,s.className="history--date",d.className="history--people",i.textContent="Delete",i.className="profile--button blue--button",l.className="overlay",c.className="popUp--container",m.textContent="Are you sure you want to delete this history?",m.setAttribute("class","message"),r.setAttribute("class",`yes deleteHistory${t+1}`),p.setAttribute("class","no"),r.setAttribute("type","button"),p.setAttribute("type","button"),r.textContent="Yes",p.textContent="No";const h={date_id:e[`history${t+1}`].date_id};i.addEventListener("click",(()=>{l.style.display="flex"})),p.addEventListener("click",(()=>{l.style.display="none"})),r.addEventListener("click",(e=>{e.preventDefault(),ne(T),l.style.display="none",fetch(te,{method:"DELETE",body:JSON.stringify(h),headers:{"content-type":"application/json"}}).then((()=>{se()}))})),n.appendChild(s),n.appendChild(d);for(var o=0,a=e[`history${t+1}`].recovered_count;o<a;o++){const n=document.createElement("p"),a=document.createElement("p"),s=document.createElement("p"),i=document.createElement("p");n.textContent=e[`history${t+1}`][`recovered${o+1}`].patient_no,a.textContent=e[`history${t+1}`][`recovered${o+1}`].age,s.textContent=e[`history${t+1}`][`recovered${o+1}`].gender,i.textContent=e[`history${t+1}`][`recovered${o+1}`].barangay,d.appendChild(n),d.appendChild(a),d.appendChild(s),d.appendChild(i)}c.appendChild(m),c.appendChild(r),c.appendChild(p),l.appendChild(c),S.appendChild(l),n.appendChild(i),T.appendChild(n)}}))}))},ie=()=>{fetch(G,{}).then((e=>{e.json().then((e=>{if(e.message){const e=document.createElement("p");e.textContent="No announcement",F.appendChild(e)}else e.reverse(),e.forEach((e=>{const t=document.createElement("div"),n=document.createElement("h3"),o=document.createElement("pre"),a=document.createElement("small"),d=document.createElement("button");t.className="announcement--post",n.textContent=e.title,o.textContent=e.body,n.className="announcement--element",o.className="announcement--element",a.className="announcement--element",a.textContent=e.date,d.className="profile--button orange--button",d.textContent="Delete";const s={id:e.id};d.addEventListener("click",(()=>{F.innerHTML="",_.style.display="block",fetch(K,{method:"DELETE",body:JSON.stringify(s),headers:{"content-type":"application/json"}}).then((e=>{_.style.display="none",ie()}))})),t.appendChild(n),t.appendChild(o),t.appendChild(a),t.appendChild(d),F.appendChild(t)}))}))}))};fetch(z,{}).then((e=>e.json().then((e=>{const t=document.createElement("h2"),n=document.createElement("div"),o=document.createElement("p"),a=document.createElement("p");t.textContent=`Name: ${e.fname} ${e.mname} ${e.lname}`,t.className="profile--name",o.className="profile--details",o.textContent=`Mobile Number: ${e.mob_no}`,a.textContent=`Admin ID: ${e.admin_id}`,n.appendChild(o),n.appendChild(a),U.appendChild(t),U.appendChild(n)})))),oe(),de(),se(),ie(),w.addEventListener("submit",(e=>{e.preventDefault();const t=new FormData(w),n=t.get("date"),o=t.get("newCases"),a=t.get("suspected"),d=t.get("probable"),s=t.get("confirmedCases"),i=t.get("testedNegative"),l=t.get("recovered"),c=t.get("death"),r=t.get("notes");let p={};new Date(n)<new Date(m.textContent)?(f.style.display="block",setTimeout((()=>{f.style.display="none"}),3e3)):(f.style.display="none",w.reset(),D.style.display="",r?(p={date_updated:n,new_cases:o,suspected:a,probable:d,confirmed_cases:s,tested_negative:i,recovered:l,death:c,notes:r},fetch(W,{method:"PUT",body:JSON.stringify(p),headers:{"content-type":"application/json"}}).then((()=>{oe(),P.textContent="Updated",P.style.bottom="50",setTimeout((()=>{P.style.bottom="-45"}),3e3)}))):(p={date_updated:n,new_cases:o,suspected:a,probable:d,confirmed_cases:s,tested_negative:i,recovered:l,death:c},fetch(W,{method:"PUT",body:JSON.stringify(p),headers:{"content-type":"application/json"}}).then((()=>{oe(),P.textContent="Updated",P.style.bottom="50",setTimeout((()=>{P.style.bottom="-45"}),3e3)}))))})),x.addEventListener("submit",(e=>{e.preventDefault();const t=document.querySelectorAll(".status"),n=new FormData(x);for(var o=0,a=t.length;o<a;o++){const e={id:parseInt(t[o].name.match(/\d+/)[0]),status:n.get(t[o].name)};fetch(Z,{method:"PUT",body:JSON.stringify(e),headers:{"content-type":"application/json"}})}P.textContent="Patient Updated",P.style.bottom="50",setTimeout((()=>{ae()}),100),setTimeout((()=>{P.style.bottom="-45"}),3e3)})),k.addEventListener("click",(e=>{B.style.display="block"})),N.addEventListener("click",(e=>{e.preventDefault(),I.reset(),B.style.display="none",L.style.display="none"})),I.addEventListener("submit",(e=>{e.preventDefault();const t=new FormData(I),n=t.get("patient_number"),o=t.get("age"),a=t.get("gender"),d=t.get("barangay"),s=t.get("status");if(n.trim().toString()&&o.trim().toString()&&a.trim().toString()&&d.trim().toString()&&s.trim().toString()){ne(b),B.style.display="none",I.reset();const e={patient_no:n,age:o,gender:a,barangay:d,status:s};fetch(Z,{method:"POST",body:JSON.stringify(e),headers:{"content-type":"application/json"}}).then((()=>{de(),ae()}))}else L.style.display="block"})),O.addEventListener("submit",(e=>{e.preventDefault();const t=new FormData(O),n=t.get("Title"),o=t.get("Body");if(n.trim().toString()&&o.trim().toString()){ne(F),j.style.display="none",O.reset();const e={title:n,body:o};fetch(K,{method:"POST",body:JSON.stringify(e),headers:{"content-type":"application/json"}}).then((e=>{D.style.display="none",ie(),e.text().then((e=>{"true"===e&&(P.textContent="Post Added",P.style.bottom="50",setTimeout((()=>{P.style.bottom="-45"}),3e3))}))}))}else j.textContent="Title and Body are required!",j.style.display="block",setTimeout((()=>{j.style.display="none"}),3e3)})),q.addEventListener("click",(()=>{fetch(z,{method:"POST"}).then((e=>{window.location.href=Y}))})),M.addEventListener("click",(()=>{$.style.display="flex"})),J.addEventListener("click",(()=>{$.style.display="none"})),H.addEventListener("click",(()=>{fetch(z,{method:"DELETE",headers:{"content-type":"application/json"}}).then((()=>{window.location.href=Y}))}))})();